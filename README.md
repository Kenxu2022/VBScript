# VBScript
some VBScript
随便玩玩

昨天捣鼓vbs的时候发现了一件有趣的事情，算是解开了我一年以来的疑惑

玩vbs的肯定都知道，脚本中包含中文字符的时候，一定要把编码格式改成"ANSI"才可以，不然会报错

但我一年前就发现了一个问题：某些时候，当我把文档编码格式设置成ANSI，保存退出，下次再打开的时候，编码格式又会跳回UTF-8

当时我还去网上搜了一下，发现好像几乎没人遇到过这样的事情，我在微软社区看到了唯一一条跟我情况差不多的，但那位老哥最终也没有解决（他甚至还重装了系统）

我还以为是记事本的问题，为此我还特地下了一个Notepad3,最后问题也没有解决（不过有一说一，Notepad3比自带的记事本不知道好用多少倍）

直到几天前，我在翻看之前编的vbs小程序的时候，才发现了端倪：所有带中文字符的脚本，编码格式不是ANSI就是GB18030，但那些不带中文字符的脚本，编码全部都是UTF-8

至此，我便有了一个猜想：不带中文字符的脚本，编码只能设置成UTF-8，就算你在另存为的时候改成其他编码格式，下次打开的时候也会被调回来

看起来不会产生什么问题，毕竟不含中文字符的vbs脚本用UTF-8编码也能跑，但看看下面这种情况：

set ws=createobject("wscript.shell")

ws.run "1.vbs"

如果1.vbs的位置在桌面上，那么他的实际路径应该是这样的：

"C:\Users\***（用户名）\OneDrive\桌面\关闭wscript.vbs"

发现问题了吧，“桌面”是中文，因此用UTF-8编码便会出现乱码，运行的时候就会报文件不存在

这个蛋疼的问题困扰了我整整一年有余，那么该如何解决呢？

其实非常简单，加一行带中文字符的注释就可以了（🤣），就像这样：

'锁住ANSI

再试一下改编码，你会发现，编码就这样神奇地被改过来了！

~（所以说写注释是一个好习惯）~

希望能帮助到你~
